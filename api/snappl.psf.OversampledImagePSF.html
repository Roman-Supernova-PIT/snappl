<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>OversampledImagePSF &#8212; roman_snpit_snappl 0.1.dev1+gb84fe5a43 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=5a6b8c39" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=f3bc516d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <script src="../_static/documentation_options.js?v=e863439e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="YamlSerialized_OversampledImagePSF" href="snappl.psf.YamlSerialized_OversampledImagePSF.html" />
    <link rel="prev" title="photutilsImagePSF" href="snappl.psf.photutilsImagePSF.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_black_filled.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">Software developed by the Roman SNPIT</p>






<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Change Log</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">snappl API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../database_schema.html">Database Schema</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api.html">snappl API</a><ul>
      <li>Previous: <a href="snappl.psf.photutilsImagePSF.html" title="previous chapter">photutilsImagePSF</a></li>
      <li>Next: <a href="snappl.psf.YamlSerialized_OversampledImagePSF.html" title="next chapter">YamlSerialized_OversampledImagePSF</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="snappl.psf.photutilsImagePSF.html" title="Previous document">photutilsImagePSF</a>
        </li>
        <li>
          <a href="snappl.psf.YamlSerialized_OversampledImagePSF.html" title="Next document">YamlSerialized_OversampledImagePSF</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="oversampledimagepsf">
<h1>OversampledImagePSF<a class="headerlink" href="#oversampledimagepsf" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="snappl.psf.OversampledImagePSF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">snappl.psf.</span></span><span class="sig-name descname"><span class="pre">OversampledImagePSF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oversample_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_odd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_parent_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snappl/psf.html#OversampledImagePSF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snappl.psf.OversampledImagePSF" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="snappl.psf.PSF.html#snappl.psf.PSF" title="snappl.psf.PSF"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSF</span></code></a></p>
<p>A PSF stored internally in an image which is (possibly) oversampled.</p>
<p>get_stamp will then interpolate the internally stored oversampled
image to get an source-image-scale sampled PSF using an
interpolation algorithm that’s close to what PSFex uses.</p>
<p>The internally stored data array is a copy of what is passed.  So,
if you have an OversampledImagePSF oipsf and do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oipsf</span><span class="o">.</span><span class="n">oversampled_data</span> <span class="o">=</span> <span class="n">data</span>
</pre></div>
</div>
<p>it does not work the way you’d usually expect for arrays.  (That is,
if you change elements of data thereafter, it will <em>not</em> be
reflected in the data array stored inside OversampledImagePSF.)</p>
<p>BIG PROBLEM : the interpolation used does a very bad job when the
PSF is intrnsically undersampled, that is, on the original image the
FWHM is not at least a couple of pixels.  (TODO: explore how the
algorithm does with PSFex-extracted PSFs on undersampled data, since
the algorithm here was written for and tested with PSFex PSFs.)  See Issue #30.</p>
<p>Make an OversampledImagePSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – <p>Required.  Position on the source image where this PSF is
evaluated.  Most of the time, but not always, you probably
want x and y to be integer values.  (As in, not integer
typed, but floats that satisfy x-floor(x)=0.)  These are
also the defaults that get_stamp will use if x and y are not
passed to get_stamp.</p>
<p>If x and/or y have nonzero fractional parts, then the data
array must be consistent.  First consider non-oversampled
data.  Suppose you pass a 11×11 array with x=1022.5 and
y=1023.25.  In this case, the peak of a perfectly symmetric
PSF image on data would be at (4.5, 5.25).  (Not (5.5,
5.25)!  If something’s at <em>exactly</em> .5, always round down
here regardless of wheter the integer part is even or odd.)
The center pixel and the one to the right of it should have
the same brightness, and the pixel just below center should
be dimmer than the pixel just above center.</p>
<p>For oversampled psfs, the data array must be properly
shifted to account for non-integral x and y.  The shift will
be as in non-oversampled data, only multiplied by the
oversampling factor.  So, in the same example, if you
specify a peak of (4.5, 5.25), and you have an oversampling
factor of 3, you should pass a 33×33 array with the peak of
the PSF (assuming a symmetric PSF) at (14.5, 16.75).</p>
<p>Note that for off-centered PSFs (meaning the PSF is not
centered on the passed data array), the meaning of (x, y) in
this constructor is <em>different</em> from the meaning of (x, y)
in the photutilsImagePSF constructor.  Use intrinsically
off-center PSFs at your own peril.  (Note that you can
always <em>render</em> stamps with off-centered PSFs in
get_stamp(), regardless of whether the PSF itself is
intrinsically centered or not.)</p>
</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – <p>Required.  Position on the source image where this PSF is
evaluated.  Most of the time, but not always, you probably
want x and y to be integer values.  (As in, not integer
typed, but floats that satisfy x-floor(x)=0.)  These are
also the defaults that get_stamp will use if x and y are not
passed to get_stamp.</p>
<p>If x and/or y have nonzero fractional parts, then the data
array must be consistent.  First consider non-oversampled
data.  Suppose you pass a 11×11 array with x=1022.5 and
y=1023.25.  In this case, the peak of a perfectly symmetric
PSF image on data would be at (4.5, 5.25).  (Not (5.5,
5.25)!  If something’s at <em>exactly</em> .5, always round down
here regardless of wheter the integer part is even or odd.)
The center pixel and the one to the right of it should have
the same brightness, and the pixel just below center should
be dimmer than the pixel just above center.</p>
<p>For oversampled psfs, the data array must be properly
shifted to account for non-integral x and y.  The shift will
be as in non-oversampled data, only multiplied by the
oversampling factor.  So, in the same example, if you
specify a peak of (4.5, 5.25), and you have an oversampling
factor of 3, you should pass a 33×33 array with the peak of
the PSF (assuming a symmetric PSF) at (14.5, 16.75).</p>
<p>Note that for off-centered PSFs (meaning the PSF is not
centered on the passed data array), the meaning of (x, y) in
this constructor is <em>different</em> from the meaning of (x, y)
in the photutilsImagePSF constructor.  Use intrinsically
off-center PSFs at your own peril.  (Note that you can
always <em>render</em> stamps with off-centered PSFs in
get_stamp(), regardless of whether the PSF itself is
intrinsically centered or not.)</p>
</p></li>
<li><p><strong>data</strong> (<em>2d numpy array</em><em> or </em><em>None</em>) – <p>The image data of the oversampled PSF.  If None, then this
needs, somehow, to be set later.  (Usually that will be
handled by something in a subclass of OversampledImagePSF;
if you’re setting it manually, you’re probably doing
something wrong.)  data.sum() should be equal to the
fraction of the PSF flux captured within the boundaries of
the data array.  (However, see “normalize” below.)  The
array must be square, and unless enforce_odd is false, the
length of one side must be an odd number.  Usually the peak
of the PSF (assuming a symmetric PSF– if not, replace
“peak” with “center” or “fiducial point” or however you
think about it) will be centered on the center pixel fo the
array.  ALWAYS the peak of the PSF must be centered within
0.5 <em>non-oversampled</em> pixels of the center of the array.
(That is, if the oversampling factor is 3, the peak of the
PSF will be centered within 1.5 pixels of the center of the
passed array.)  See (x,y) below for discussion of
positioning the PSF on the passed data array.</p>
<p>A <em>copy</em> of the passed data is stored, not the actual passed
data, so if you change elements of the array you passed
after making the OversampledImagePSF, it won’t be reflected
inside the OversampledImagePSF.</p>
</p></li>
<li><p><strong>oversample_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default 1.</em>) – There are this many pixels along one axis in data for one
pixel in the original image.  Doesn’t have to be an integer
(e.g. if you used PSFex to find the PSF, it usually won’t
be— though if you used PSFex to find the PSF, really we
should be writing a subclass to handle that!).</p></li>
<li><p><strong>enforce_odd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default True</em>) – Enforce the requirement that the data array have an odd length along each axis.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default False</em>) – Ignored if data is not None.  If True, then this constructor
will make sure that data sums to 1 (modifying the passed
data array in so doing!).  If you think that the data array
is big enough that you’re effectively capturing 100% of the
PSF flux, then you should set normalize to True.  If not,
then you should make sure that the data array you pass sums
to the fraction of the PSF flux that you’re passing, and set
normalize to False.  Usually you don’t want to change this,
and you want to trust subclases to do the Right Thing.</p></li>
<li><p><strong>_parent_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default False</em>) – Used internally, do not use.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)">object</a> of type cls</p>
</dd>
</dl>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#snappl.psf.OversampledImagePSF.oversample_factor" title="snappl.psf.OversampledImagePSF.oversample_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">oversample_factor</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#snappl.psf.OversampledImagePSF.oversampled_data" title="snappl.psf.OversampledImagePSF.oversampled_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">oversampled_data</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#snappl.psf.OversampledImagePSF.stamp_size" title="snappl.psf.OversampledImagePSF.stamp_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stamp_size</span></code></a></p></td>
<td><p>The size of the PSF image stamp at image resolution.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#snappl.psf.OversampledImagePSF.getImagePSF" title="snappl.psf.OversampledImagePSF.getImagePSF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getImagePSF</span></code></a>([imagesampled])</p></td>
<td><p>Return a photutils.psf.ImagePSF model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#snappl.psf.OversampledImagePSF.get_stamp" title="snappl.psf.OversampledImagePSF.get_stamp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_stamp</span></code></a>([x, y, x0, y0, flux])</p></td>
<td><p>See PSF.get_stamp for documentation</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="snappl.psf.OversampledImagePSF.oversample_factor">
<span class="sig-name descname"><span class="pre">oversample_factor</span></span><a class="headerlink" href="#snappl.psf.OversampledImagePSF.oversample_factor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snappl.psf.OversampledImagePSF.oversampled_data">
<span class="sig-name descname"><span class="pre">oversampled_data</span></span><a class="headerlink" href="#snappl.psf.OversampledImagePSF.oversampled_data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="snappl.psf.OversampledImagePSF.stamp_size">
<span class="sig-name descname"><span class="pre">stamp_size</span></span><a class="headerlink" href="#snappl.psf.OversampledImagePSF.stamp_size" title="Link to this definition">¶</a></dt>
<dd><p>The size of the PSF image stamp at image resolution.  Is always odd.</p>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="snappl.psf.OversampledImagePSF.getImagePSF">
<span class="sig-name descname"><span class="pre">getImagePSF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imagesampled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snappl/psf.html#OversampledImagePSF.getImagePSF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snappl.psf.OversampledImagePSF.getImagePSF" title="Link to this definition">¶</a></dt>
<dd><p>Return a photutils.psf.ImagePSF model.  See PSF.getImagePSF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="snappl.psf.OversampledImagePSF.get_stamp">
<span class="sig-name descname"><span class="pre">get_stamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snappl/psf.html#OversampledImagePSF.get_stamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snappl.psf.OversampledImagePSF.get_stamp" title="Link to this definition">¶</a></dt>
<dd><p>See PSF.get_stamp for documentation</p>
<p>–&gt; CURRENTLY BROKEN FOR UNDERSAMPLED PSFs.  See Issue #30.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="snappl.psf.photutilsImagePSF.html" title="Previous document">photutilsImagePSF</a>
        </li>
        <li>
          <a href="snappl.psf.YamlSerialized_OversampledImagePSF.html" title="Next document">YamlSerialized_OversampledImagePSF</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, Roman Supernova PIT.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/api/snappl.psf.OversampledImagePSF.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>